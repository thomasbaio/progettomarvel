<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Marvel card vault (AFSE) - Base page">
		<title>
			Create trade
		</title>
		<!-- import of the logo -->
		<link rel="icon" href="../images/logo.png" type="image/x-icon">
		<!-- import of custom CSS-->
		<link rel="stylesheet" href="../css/style.css">
		<link rel="stylesheet" href="../css/card.css">
	</head>
<body >
		<div id="menu"></div>
		<div class="container">
			<div class="row">
				<div class="col-md-12">
						<h1>Create exchange</h1>
					<p>In tihs page you can create an exchange.<br>
						You con only trade in a card that you have at least twice, and you can oly request a card that you don't have.
						<a href="/sell_cards" class="btn btn-success hidden" id="card_sell"><i class="fas fa-dollar-sign"></i> Sell duplicate cards</a>
					</p>
				</div>
			</div>
			<div class="row p-4 md-4">
				<div class="col-md-12">
					<div class="button-container" style="width:100%; display: inline-table;">
						<div id="lock" class="text-center hidden">
							<p class="text-danger" id="error_Message"></p>
							<i class="fas fa-lock fa-2x"></i>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div id="pack_cards" class="pack_cards">
						</div>
					</div>
				</div>
				<div class="row hidden" id="recieveCard">
					<div class="col-md-12">
						<p> Select the card that you want to obtain with this exchange</p>
						<div class="form-floating mb-3 ">
							<div class="form-floating">
								<input type="text" 
									   class="form-control" 
									   id="select_superhero" 
									   placeholder="Requested superhero"
									   autocomplete="off"
									   required="required">
								<label for="select_superhero">Requested superhero</label>
								<div class="dropdown-menu w-100" id="resultsDropdown">
									<ul class="search-results" id="searchResults">
										<!-- Results will be populated here -->
									</ul>
									<div class="text-center p-2 d-none" id="loadingIndicator">
										<div class="spinner-border spinner-border-sm" role="status">
											<span class="visually-hidden">Loading...</span>
										</div>
									</div>
								</div>
							</div>
							<input type="hidden" id="selected_Superhero">
						</div>
					</div>
				<button class="btn btn-success" onclick="createExchange()">Create exchange</button>	
				</div>
				</div> 
			</div>
		<footer id="footer"></footer>
		<script >
	async  function toggleLock() {
		const lockDiv = document.getElementById('lock');
		const credits = await get_credits();
		if (!localStorage.getItem("album_ID") || credits < 1  ) {
			lockDiv.classList.add('active');
			if (!localStorage.getItem("album_ID")) {
				document.getElementById("error_Message").textContent = "Please select an album first";
			}
			else
			{
				document.getElementById("error_Message").textContent = "Not enough credits";
			}
			lockDiv.classList.remove('hidden');
		} else {
			lockDiv.classList.remove('active');
			lockDiv.classList.add('hidden');
		}
	}
		</script>
			<!-- import of JS -->
			<script src="../scripts/theme.js"></script>
			<!-- import of the bootstrap js -->
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
			<!-- import of the jquery -->
			<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
			<script src="../scripts/marvel.js"></script>
			<script src="../scripts/navbar.js"></script>
			<script src="../scripts/login.js"></script>
			<script src="../scripts/register.js"></script>
			<script type="module" src="../scripts/footer.js"></script>
			<script>
			</script>
			<script> 
				printCredits();
				toggleLock();
				var albumid = localStorage.getItem("album_ID");
                printDuplicatedAlbumCards(albumid);
			</script>
		<!-- end of import of JS -->
	</body>
</html>